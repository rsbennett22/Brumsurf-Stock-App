{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Brumsurf Stock App</title>
</head>
<body onload="setDefaultsAndReload()">
    <button onclick="location.href='/'">Home</button>
    <h1>{{stockType}}</h1>
    <h2 id="brand" brand="{{brand}}">Brand: {{brand}}</h2>
    <h2 id="gender" gender="{{gender}}">Gender: {{gender}}</h2>
    <h2 id="size" size="{{size}}">Size: {{size}}</h2>
    <h2 id="number" number="{{number}}">Wetsuit number: {{number}}</h2>
    <h2 id="status"></h2>
    <img src="{% static qrPath %}" alt="Item url">
    <br>
    <form onsubmit="return confirm('Sign out wetsuit {{number}}?')" action="{{signOutUrl}}" method="POST">
        {% csrf_token %}
        <input id="signOutUrl" name="url" value="" hidden>
        <button id="signOut" onclick="setCurrentUrl('signOutUrl')" type="submit">Sign Out</button>
    </form>
    <form onsubmit="return confirm('Sign in wetsuit {{number}}?')" action="{{signInUrl}}" method="POST">
        {% csrf_token %}
        <input id="signInUrl" name="url" value="" hidden>
        <button id="signIn" onclick="setCurrentUrl('signInUrl')" type="submit">Sign In</button>
    </form>
    <form onsubmit="return confirm('Trip sign out wetsuit {{number}}?')" action="{{onTripUrl}}" method="POST">
        {% csrf_token %}
        <input id="onTripUrl" name="url" value="" hidden>
        <button id="onTrip" onclick="setCurrentUrl('onTripUrl')" type="submit">Trip Sign Out</button>
    </form>
    <form id="deleteItem" onsubmit="return confirm('Are you sure you want to delete this wetsuit?')" action="{{deleteUrl}}" method="POST">
        {% csrf_token %}
        <button type="submit">Delete</button>
    </form>
    <script>
        function setCurrentUrl(id){
            console.log(id)
            document.getElementById(id).value=location.href
        }

        function setDefaultsAndReload() {

            //Get status of item, signedIn, signedOut and onTrip and disable/enable buttons accordingly
            var signedIn = "{{signedIn}}";
            var signedOut = "{{signedOut}}";
            var onTrip = "{{onTrip}}";
            
            //Set relevant buttons based on values of above vars
            if(signedIn=='True') {
                //Get sign in button and disable it
                document.getElementById('signIn').disabled = true;
            }
            else if(onTrip=='True' || signedOut=='True') {
                document.getElementById('onTrip').disabled = true;
                document.getElementById('signOut').disabled = true;
            }

            if(window.location.href == 'http://192.168.0.58:8000/addNewWetsuit/')
            {
                brand = document.getElementById('brand').getAttribute('brand');
                gender = document.getElementById('gender').getAttribute('gender');
                size = document.getElementById('size').getAttribute('size');
                number = document.getElementById('number').getAttribute('number');
                console.log(brand, gender, size, number);
                window.location.replace('../wetsuit/'+brand+'&'+gender+'&'+size+'&'+number);
            }
        }
    </script>
</body>
</html>